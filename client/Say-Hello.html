<head>
	<title>Say Hello Web-App</title> <!-- master -->
	
	<script src="https://maps.googleapis.com/maps/api/js?sensor=true"></script>
	
		<meta name="viewport" content="width=device-width, initial-scale=1">
				<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.css">
			<!--	<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
				<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.4.2.min.js"></script> -->
				<script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
				<script src="http://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.js"></script>

	<script>
	$(function() {
		$( "#tabs" ).tabs();
	});
/*
	$(document).delegate('[data-role="navbar"] a', 'click', function () {
	    $(thi).addClass('ui-btn-active');
	    $('.ui-content').hide();
	    $('#' + $(this).attr('data-href')).show();
	    return false;//stop default behavior of link
	});
*/
	</script>
<!--
	<script>
		var init_stuff;
		function initialize() {
			init_stuff = window.setInterval(function() {
			window.clearInterval(init_stuff);
			var map_canvas = document.getElementById("map_canvas");
			var map_options = {
				center: new google.maps.LatLng(40.4319, -86.9202),
				zoom: 16,
				scrollwheel: false,
				disableDoubleClickZoom: true,
				streetViewControl: false
			}
			var map = new google.maps.Map(map_canvas, map_options);
			//google.maps.event.addListener(map, 'idle', function() {
				// generate markers
			//	alert("Google Map Loaded.");
				/*
				for (var _event in CurrentEvents.find().fetch()) {
					console.log("Event: " + _event[0]);
					var marker = getMarker(_event.x, _event.y);
					marker.setMap(map);
				}
				*/
				CurrentEvents.find().forEach(function(_event) {
					console.log("Event: " + _event.name);
					var marker = getMarker(_event.x, _event.y);
					marker.setMap(map);
				});
			//});
			google.maps.event.addListener(map, 'dblclick', function(mouse) {
				console.log("Lat: " + mouse.latLng.lat() + 
						"\nLong: " + mouse.latLng.lng());
				if (! Meteor.userId)
					return; // not logged in
				var coords = mouse.latLng
				openCreateDialog(coords.lat(), coords.lng());
			});
			}, 100);
		}
		var openCreateDialog = function(x, y) {
			Session.set("createCoords", {x: x, y: y});
			Session.set("createError", null);
			Session.set("showCreateDialog", true);
			//initialize();
		};

		function getMarker(x, y) {
			return new google.maps.Marker({
				position: new google.maps.LatLng(x, y)
			});
		}
		google.maps.event.addDomListener(window, 'load', initialize);
		var createDia = false;
		Deps.autorun(function(c) {
			var boo = Session.get("showCreateDialog");
			if (createDia == true && boo != createDia) {
				createDia = boo;
				initialize();
			} else {
				createDia = boo;
			}
			c.stop();
		});
	</script>
-->
</head>

<body>
	<div data-role="page" id="foo">

		<div data-role="header" data-theme="b">
			<div class="login-container">
				{{#isolate}}
					{{loginButtons align="right"}}
				{{/isolate}}
			</div>
			<h1>Say Hello</h1>	
		</div><!-- /header -->
		{{> everything}}
  
 	
	</div><!-- /page -->
</body>

<template name="everything">
	{{#isolate}}
	{{#if showEventDetails}}
		{{> details}}
	{{/if}}
	{{/isolate}}
	<div data-role="none" class="content-body" data-theme="b">	
		{{> page}}
	</div>
	<div data-role="footer" class="footer" data-theme="b" id="footer">
		{{#isolate}}
			{{> footer}}
		{{/isolate}}
	</div><!-- /footer -->
</template>

<template name="page">
	{{#isolate}}
		{{#if showCreateDialog}}
			{{> createDialog}}
		{{/if}}
	{{/isolate}}

	{{> map}}
	<script>
	initialize();
	</script>
</template>

<template name="map">
	<div data-role="none" class="map" id="map_canvas" onload="initialize();">
	</div>
</template>

<template name="details">
	<div class="mask"> </div>
	<div class="modal">
	{{#if _event}}
		{{#with _event}}
		<div class="modal-header">
			<button type="button" class="close cancel">&times;</button>
			<h2>{{name}}</h2>
			<div class="well well-small">{{description}}</div>
		</div>
		<div class="modal-body">
			<!-- <div class="description">{{description}}</div> -->

			{{#if currentUser}}
				{{#if attending}}
					{{#if signedIn _event currentUser}}
						{{> attendance}}
					{{/if}}
				{{/if}}
			{{/if}}

			<div class="sign_in-out_buttons">
				{{#if currentUser}}
					{{#if signedIn _event currentUser}}
						<input type="button" value="Sign Out" class="sign btn sign-out"/>
					{{else}}
						<input type="button" value="Sign In" class="sign btn sign-in" />
					{{/if}}
					<p><small>Posted by {{creatorName}}</small></p>
				{{else}}
					<i>Log in to sign into this event.</i><br />
					<i>Signing in to an event allows you to see who all is there.</i>
				{{/if}}
			</div>

			{{#if canClose}}
							{{/if}}
		</div>
		{{/with}}
	{{else}}
		<h1 class="muted pagination-centered">
			{{#if anyEvents}}
				Click a party to select it or log in to create your own event!
			{{else}}
				Log in and double click the map to post an event.
			{{/if}}
		</h1>
	{{/if}}
	</div>
</template>

<template name="attendance">
	<div class="attendance well well-small">
		<div class="muted who"><b>Who Is Here:</b></div>
	
		<!-- <ul data-role="listview" id="attendee-list" data-inset="true">	-->
		{{#each attendees}}
			<a href="#" id="name">{{name}}</a>
			<a href="#" class="link" id="shareContact">


			  <!-- Share Contact Info -->
				<img title="Share Details with this Person" src="link.png" height="32px" width="32px" alt="Share Details with this Person" />
				
			</a>
			<br />
		{{/each}}

	</div>
</template>


<template name="createDialog">
	<div class="mask"> </div>
	<div class="modal">
		<div class="modal-header">
			<button type="button" class="close cancel">&times;</button>
			<h3>Add Event</h3>
		</div>

		<div class="modal-body">
			{{#if error}}
				<div class="alert alert-error">{{error}}</div>
			{{/if}}

			<label>Name</label>
			<input type="text" class="name span5" />

			<label>Description</label>
			<textarea class="description span5"></textarea>
		</div>
		<div class="modal-footer">
			<a href="#" class="btn cancel">Cancel</a>
			<a href="#" class="btn btn-primary save">Add Event</a>
		</div>
	</div>
</template>

<template name="footer">
	<div data-role="tabs" id="footer-tabs">
	<div data-role="navbar" id="footer-nav">
		<ul>
			<li><a href="#epanel" data-href="epanel" class="ui-btn-active"><h2>Events</h2></a></li>
			<li><a href="#ppanel" data-href="ppanel"><h2>People</h2></a></li>
			<li><a href="#apanel" data-href="apanel"><h2>Account</h2></a></li>
		</ul>
	</div><!-- /navbar -->
	<div id="epanel" class="ui-content" style="overflow-y: auto;">
  <ul id="event-list" data-role="listview" data-inset="true">
    <li><a href="#" id="create">Create New Event</a></li>
 
		{{> event_list}}
    <li><a href="#" id="moar">Load more ...</a></li>
        <li><a href="#" id="past-current">View Past Events</a></li>
    
  </ul>
	</div>
	
	<div id="ppanel" class="ui-content" style="overflow-y: auto;">
		{{> people_tab}}
	</div>
	<div id="apanel" class="ui-content" style="overflow-y: auto;">
		{{> account_tab}}
	</div>
	</div>
</template>

<template name="event_list">
  <!--input type="button" class="ui-btn new-event" value="Create New Event" / -->
 {{#if event_list}} 
    {{#each event_list}}
<<<<<<< HEAD

=======
<<<<<<< HEAD
>>>>>>> 92567ea8be467ab929f7b38707e39ef049033cba
    
    <li><a href="#" class="event-item" name="{{_id}}">{{name}}</a></li>
    
    {{/each}} 
    <li><a href="#" id="moar">Load more ...</a></li>
    
    

  
  
  
  
  
 
    <li><a href="#" id="past-current">View Past Events</a></li>
    {{#each event_list_past}}
    
    <li><a href="#" class="event-item" name="{{_id}}">{{name}}</a></li>
    
<<<<<<< HEAD

        <li><a href="#" class="event-item" name="{{_id}}" data-theme="a">{{name}}</a></li>

=======
=======
        <li><a href="#" class="event-item" name="{{_id}}" data-theme="a">{{name}}</a></li>
>>>>>>> d247efd2c6111073cf97f628afc17e5d619bd55a
>>>>>>> 92567ea8be467ab929f7b38707e39ef049033cba
    {{/each}}
  {{/if}}
</template>

<template name="people_tab">
	<h1>People go here</h1>
</template>

<template name="account_tab">
	<h2>Profile</h2>
	<div>
	<img id="prof" src="">
	</div>
	<div>
	<label for="firstname">First Name:</label>
	<input type="text" id="changefirst" style="display:none" />
	<label for="outputfirstname" id="outputfirst"></label>
	</div>
	<div>
	<label for="lastname">Last Name:</label>
	<input type="text" id="changelast" style="display:none">
	<label for="outputlastname" id="outputlast" style="display:inline"></label>
	</div>
	<div>
	<label for="email">Email:</label>
	<input type="text" id="changeemail" style="display:none">
	<label for="outputemail" id="outputemail" style="display:inline"></label>
	</div>
	<div>
	<label for="phone">Phone Number:</label>
	<input type="text" id="changephone" style="display:none">
	<label for="outputphone" id="outputphone" style="display:inline"></label>
	</div>
	<div>
	<label for="gender">Gender:</label>
	<input type="text" id="changegender" style="display:none">
	<label for="outputgender" id="outputgender" style="display:inline"></label>
	</div>
	<div data-inline="true">
	<input type="button" class="save" value="Save" style="display:inline" />
	<input type="button" class="set" value="Get Info" style="display:inline" />
	<input type="button" class="edit" value="Edit" style="display:inline"/>
	</div>


	<!-- Present Friend List from here -->
	
	<h1>Friends</h1>
	{{#each friendListFinal}}
	{{this}}<br>
	{{/each}}



	
	
	
</template>
